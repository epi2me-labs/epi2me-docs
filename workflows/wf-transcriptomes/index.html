
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://epi2me.nanoporetech.com/epi2me-docs/workflows/wf-transcriptomes/">
      
      
        <link rel="prev" href="../wf-template/">
      
      
        <link rel="next" href="../wf-basecalling/">
      
      
      <link rel="icon" href="../../assets/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.12">
    
    
      
        <title>wf-transcriptomes - Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.2afb09e1.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="ont" data-md-color-primary="custom" data-md-color-accent="custom">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#workflow-transcriptomes" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      <!--
  Copyright (c) 2016-2024 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->

<!-- Determine classes -->


  


<!-- Header -->
<header class="md-header md-header--shadow" data-md-component="header">
  <nav
    class="md-header__inner md-grid"
    aria-label="Header"
  >

    <!-- Link to home -->
    <a
      href="https://epi2me.nanoporetech.com"
      title="Documentation"
      class="md-header__button md-logo"
      aria-label="Documentation"
      data-md-component="logo"
    >
      
  <img src="../../assets/logo-dark.png" alt="logo">

    </a>

    <!-- Button to open drawer -->
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>

    <!-- Header title -->
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <a
            href="https://epi2me.nanoporetech.com/epi2me-docs/"
            title="https://epi2me.nanoporetech.com/epi2me-docs/"
            aria-label="Documentation"
          >
            <span class="md-ellipsis">
              Documentation
            </span>
          </a>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              wf-transcriptomes
            
          </span>
        </div>
      </div>
    </div>

    <!-- Color palette toggle -->
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="ont" data-md-color-primary="custom" data-md-color-accent="custom"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="ont-dark" data-md-color-primary="custom" data-md-color-accent="custom"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    

    <!-- User preference: color palette -->
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    

    <!-- Site language selector -->
    

    <!-- Button to open search modal -->
    

    <!-- Repository information -->
    
  </nav>

  <!-- Navigation tabs (sticky) -->
  


  <!-- heap analytics -->
  
  <script>
    // function to load heap
    function loadHeap() {
      window.heap = window.heap || [];
      heap.load = function(e, t) {
        window.heap.appid = e;
        heap.config = t = t || {};
        var r = document.createElement("script");
        r.type = "text/javascript";
        r.async = true;
        r.src = "https://cdn.heapanalytics.com/js/heap-" + e + ".js";
        var a = document.getElementsByTagName("script")[0];
        a.parentNode.insertBefore(r, a);
        var n = function(e) {
          return function() {
            heap.push([e].concat(Array.prototype.slice.call(arguments, 0)));
          };
        };
        var p = [
          "addEventProperties", "addUserProperties", "clearEventProperties", "identify",
          "resetIdentity", "removeEventProperty", "setEventProperties", "track", "unsetEventProperty"
        ];
        for (var o = 0; o < p.length; o++) heap[p[o]] = n(p[o]);
      };
      heap.load("2162541267");
    }
  
    // Check existing consent
    var consent = __md_get && __md_get("__consent");
    if (consent && consent.custom) {
      loadHeap();
    }
  
    // React to consent changes (e.g., user toggles it later)
    document.addEventListener("md-consent-change", function () {
      var updated = __md_get && __md_get("__consent");
      if (updated && updated.custom && !window.heap) {
        loadHeap();
      }
    });
  </script>
  

</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://epi2me.nanoporetech.com" title="Documentation" class="md-nav__button md-logo" aria-label="Documentation" data-md-component="logo">
      
  <img src="../../assets/logo-dark.png" alt="logo">

    </a>
    Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../quickstart/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    EPI2ME Desktop
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1" id="__nav_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            EPI2ME Desktop
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://epi2me.nanoporetech.com/downloads" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Download
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../wfquickstart/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Workflows
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Workflows
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../wf-pore-c/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    wf-pore-c
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../wf-bacterial-genomes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    wf-bacterial-genomes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../wf-human-variation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    wf-human-variation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../wf-aav-qc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    wf-aav-qc
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../wf-somatic-variation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    wf-somatic-variation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../wf-artic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    wf-artic
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../wf-16s/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    wf-16s
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../wf-amplicon/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    wf-amplicon
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../wf-tb-amr/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    wf-tb-amr
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../wf-template/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    wf-template
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    wf-transcriptomes
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    wf-transcriptomes
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#compute-requirements" class="md-nav__link">
    <span class="md-ellipsis">
      Compute requirements
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#install-and-run" class="md-nav__link">
    <span class="md-ellipsis">
      Install and run
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#related-protocols" class="md-nav__link">
    <span class="md-ellipsis">
      Related protocols
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#input-example" class="md-nav__link">
    <span class="md-ellipsis">
      Input example
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#input-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Input parameters
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Input parameters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#input-options" class="md-nav__link">
    <span class="md-ellipsis">
      Input Options
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output-options" class="md-nav__link">
    <span class="md-ellipsis">
      Output Options
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sample-options" class="md-nav__link">
    <span class="md-ellipsis">
      Sample Options
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#options-for-reference-based-workflow" class="md-nav__link">
    <span class="md-ellipsis">
      Options for reference-based workflow
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#differential-expression-options" class="md-nav__link">
    <span class="md-ellipsis">
      Differential Expression Options
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#advanced-options" class="md-nav__link">
    <span class="md-ellipsis">
      Advanced Options
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#outputs" class="md-nav__link">
    <span class="md-ellipsis">
      Outputs
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pipeline-overview" class="md-nav__link">
    <span class="md-ellipsis">
      Pipeline overview
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Pipeline overview">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-concatenate-input-files-and-generate-per-read-stats" class="md-nav__link">
    <span class="md-ellipsis">
      1. Concatenate input files and generate per read stats.
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-preprocess-cdna" class="md-nav__link">
    <span class="md-ellipsis">
      2. Preprocess cDNA.
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-build-transcriptome" class="md-nav__link">
    <span class="md-ellipsis">
      3. Build transcriptome.
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Build transcriptome.">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-align-reads-with-reference-genome" class="md-nav__link">
    <span class="md-ellipsis">
      3.1 Align reads with reference genome.
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-chunk-bam" class="md-nav__link">
    <span class="md-ellipsis">
      3.2 Chunk BAM
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-assemble-transcripts" class="md-nav__link">
    <span class="md-ellipsis">
      3.3 Assemble transcripts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34-merge-chunks" class="md-nav__link">
    <span class="md-ellipsis">
      3.4 Merge Chunks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#35-annnotate" class="md-nav__link">
    <span class="md-ellipsis">
      3.5 Annnotate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#36-create-transcriptomes" class="md-nav__link">
    <span class="md-ellipsis">
      3.6 Create transcriptomes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-differential-expression-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      4. Differential expression analysis
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Differential expression analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sample-sheet-condition-column" class="md-nav__link">
    <span class="md-ellipsis">
      Sample sheet condition column
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#41-merge-cross-sample-transcriptomes" class="md-nav__link">
    <span class="md-ellipsis">
      4.1 Merge cross sample transcriptomes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-create-a-final-non-redundant-transcriptome" class="md-nav__link">
    <span class="md-ellipsis">
      4.2 Create a final non redundant transcriptome
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43-count-genes-and-transcripts" class="md-nav__link">
    <span class="md-ellipsis">
      4.3 Count genes and transcripts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#44-edger-based-differential-expression-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      4.4 edgeR based differential expression analysis
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#45-pre-filtering-of-quantitative-data-using-drimseq" class="md-nav__link">
    <span class="md-ellipsis">
      4.5 Pre-filtering of quantitative data using DRIMSeq
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#46-differential-transcript-usage-using-dexseq" class="md-nav__link">
    <span class="md-ellipsis">
      4.6 Differential transcript usage using DEXSeq
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#47-stager-stage-wise-analysis-of-dge-and-dtu" class="md-nav__link">
    <span class="md-ellipsis">
      4.7 StageR stage-wise analysis of DGE and DTU
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting" class="md-nav__link">
    <span class="md-ellipsis">
      Troubleshooting
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#faqs" class="md-nav__link">
    <span class="md-ellipsis">
      FAQ's
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#related-blog-posts" class="md-nav__link">
    <span class="md-ellipsis">
      Related blog posts
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../wf-basecalling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    wf-basecalling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../wf-clone-validation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    wf-clone-validation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../wf-cas9/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    wf-cas9
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../wf-alignment/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    wf-alignment
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../wf-flu/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    wf-flu
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../wf-metagenomics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    wf-metagenomics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../wf-mpx/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    wf-mpx
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../wf-single-cell/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    wf-single-cell
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../help/useful-links/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Help
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Help
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../help/troubleshooting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Troubleshooting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../help/faq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FAQ
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../help/contact-us/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contact Us
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../help/information-governance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Information Governance
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#compute-requirements" class="md-nav__link">
    <span class="md-ellipsis">
      Compute requirements
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#install-and-run" class="md-nav__link">
    <span class="md-ellipsis">
      Install and run
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#related-protocols" class="md-nav__link">
    <span class="md-ellipsis">
      Related protocols
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#input-example" class="md-nav__link">
    <span class="md-ellipsis">
      Input example
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#input-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Input parameters
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Input parameters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#input-options" class="md-nav__link">
    <span class="md-ellipsis">
      Input Options
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output-options" class="md-nav__link">
    <span class="md-ellipsis">
      Output Options
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sample-options" class="md-nav__link">
    <span class="md-ellipsis">
      Sample Options
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#options-for-reference-based-workflow" class="md-nav__link">
    <span class="md-ellipsis">
      Options for reference-based workflow
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#differential-expression-options" class="md-nav__link">
    <span class="md-ellipsis">
      Differential Expression Options
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#advanced-options" class="md-nav__link">
    <span class="md-ellipsis">
      Advanced Options
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#outputs" class="md-nav__link">
    <span class="md-ellipsis">
      Outputs
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pipeline-overview" class="md-nav__link">
    <span class="md-ellipsis">
      Pipeline overview
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Pipeline overview">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-concatenate-input-files-and-generate-per-read-stats" class="md-nav__link">
    <span class="md-ellipsis">
      1. Concatenate input files and generate per read stats.
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-preprocess-cdna" class="md-nav__link">
    <span class="md-ellipsis">
      2. Preprocess cDNA.
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-build-transcriptome" class="md-nav__link">
    <span class="md-ellipsis">
      3. Build transcriptome.
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Build transcriptome.">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-align-reads-with-reference-genome" class="md-nav__link">
    <span class="md-ellipsis">
      3.1 Align reads with reference genome.
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-chunk-bam" class="md-nav__link">
    <span class="md-ellipsis">
      3.2 Chunk BAM
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-assemble-transcripts" class="md-nav__link">
    <span class="md-ellipsis">
      3.3 Assemble transcripts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34-merge-chunks" class="md-nav__link">
    <span class="md-ellipsis">
      3.4 Merge Chunks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#35-annnotate" class="md-nav__link">
    <span class="md-ellipsis">
      3.5 Annnotate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#36-create-transcriptomes" class="md-nav__link">
    <span class="md-ellipsis">
      3.6 Create transcriptomes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-differential-expression-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      4. Differential expression analysis
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Differential expression analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sample-sheet-condition-column" class="md-nav__link">
    <span class="md-ellipsis">
      Sample sheet condition column
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#41-merge-cross-sample-transcriptomes" class="md-nav__link">
    <span class="md-ellipsis">
      4.1 Merge cross sample transcriptomes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-create-a-final-non-redundant-transcriptome" class="md-nav__link">
    <span class="md-ellipsis">
      4.2 Create a final non redundant transcriptome
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43-count-genes-and-transcripts" class="md-nav__link">
    <span class="md-ellipsis">
      4.3 Count genes and transcripts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#44-edger-based-differential-expression-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      4.4 edgeR based differential expression analysis
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#45-pre-filtering-of-quantitative-data-using-drimseq" class="md-nav__link">
    <span class="md-ellipsis">
      4.5 Pre-filtering of quantitative data using DRIMSeq
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#46-differential-transcript-usage-using-dexseq" class="md-nav__link">
    <span class="md-ellipsis">
      4.6 Differential transcript usage using DEXSeq
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#47-stager-stage-wise-analysis-of-dge-and-dtu" class="md-nav__link">
    <span class="md-ellipsis">
      4.7 StageR stage-wise analysis of DGE and DTU
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting" class="md-nav__link">
    <span class="md-ellipsis">
      Troubleshooting
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#faqs" class="md-nav__link">
    <span class="md-ellipsis">
      FAQ's
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#related-blog-posts" class="md-nav__link">
    <span class="md-ellipsis">
      Related blog posts
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="workflow-transcriptomes">Workflow Transcriptomes</h1>
<p>Transcriptome analysis of cDNA and direct RNA sequencing data.</p>
<h2 id="introduction">Introduction</h2>
<p>This workflow can be used for the following:</p>
<ul>
<li>Identify RNA transcripts using either cDNA or direct RNA reads.</li>
<li>Reference aided transcriptome assembly.</li>
<li>Annotation of assembled transcripts.</li>
<li>Differential gene expression analysis using a pre-computed or assembled reference transcriptome.</li>
<li>Differential transcript usage analysis using a precomputed or assembled reference transcriptome.</li>
</ul>
<h2 id="compute-requirements">Compute requirements</h2>
<p>Recommended requirements:</p>
<ul>
<li>CPUs = 16</li>
<li>Memory = 64GB</li>
</ul>
<p>Minimum requirements:</p>
<ul>
<li>CPUs = 8</li>
<li>Memory = 32GB</li>
</ul>
<p>Approximate run time: 15 minutes per sample, with 1 million reads and recommended resources.</p>
<p>ARM processor support: False</p>
<h2 id="install-and-run">Install and run</h2>
<p>These are instructions to install and run the workflow on command line.
You can also access the workflow via the
<a href="https://labs.epi2me.io/downloads/">EPI2ME Desktop application</a>.</p>
<p>The workflow uses <a href="https://www.nextflow.io/">Nextflow</a> to manage
compute and software resources,
therefore Nextflow will need to be
installed before attempting to run the workflow.</p>
<p>The workflow can currently be run using either
<a href="https://www.docker.com/products/docker-desktop">Docker</a>
or <a href="https://docs.sylabs.io/guides/3.0/user-guide/index.html">Singularity</a>
to provide isolation of the required software.
Both methods are automated out-of-the-box provided
either Docker or Singularity is installed.
This is controlled by the
<a href="https://www.nextflow.io/docs/latest/config.html#config-profiles"><code>-profile</code></a>
parameter as exemplified below.</p>
<p>It is not required to clone or download the git repository
in order to run the workflow.
More information on running EPI2ME workflows can
be found on our <a href="https://labs.epi2me.io/wfindex">website</a>.</p>
<p>The following command can be used to obtain the workflow.
This will pull the repository in to the assets folder of
Nextflow and provide a list of all parameters
available for the workflow as well as an example command:</p>
<pre><code>nextflow run epi2me-labs/wf-transcriptomes --help
</code></pre>
<p>To update a workflow to the latest version on the command line use
the following command:</p>
<pre><code>nextflow pull epi2me-labs/wf-transcriptomes
</code></pre>
<p>A demo dataset is provided for testing of the workflow.
It can be downloaded and unpacked using the following commands:</p>
<pre><code>wget https://ont-exd-int-s3-euwst1-epi2me-labs.s3.amazonaws.com/wf-transcriptomes/wf-transcriptomes-demo.tar.gz
tar -xzvf wf-transcriptomes-demo.tar.gz
</code></pre>
<p>The workflow can then be run with the downloaded demo data using:</p>
<pre><code>nextflow run epi2me-labs/wf-transcriptomes \
    --de_analysis \
    --direct_rna \
    --fastq 'wf-transcriptomes-demo/differential_expression_fastq' \
    --minimap2_index_opts '-k 15' \
    --ref_annotation 'wf-transcriptomes-demo/gencode.v22.annotation.chr20.gtf' \
    --ref_genome 'wf-transcriptomes-demo/hg38_chr20.fa' \
    --sample_sheet 'wf-transcriptomes-demo/sample_sheet.csv' \
    -profile standard
</code></pre>
<p>For further information about running a workflow on
the command line see https://labs.epi2me.io/wfquickstart/</p>
<h2 id="related-protocols">Related protocols</h2>
<p>This workflow is designed to take input sequences that have been produced from <a href="https://nanoporetech.com/">Oxford Nanopore Technologies</a> devices.</p>
<p>Find related protocols in the <a href="https://community.nanoporetech.com/docs/">Nanopore community</a>.</p>
<h2 id="input-example">Input example</h2>
<!---Example of input directory structure, delete and edit as appropriate per workflow.--->
<p>This workflow accepts either FASTQ or BAM files as input.</p>
<p>The FASTQ or BAM input parameters for this workflow accept one of three cases: (i) the path to a single FASTQ or BAM file; (ii) the path to a top-level directory containing FASTQ or BAM files; (iii) the path to a directory containing one level of sub-directories which in turn contain FASTQ or BAM files. In the first and second cases (i and ii), a sample name can be supplied with <code>--sample</code>. In the last case (iii), the data is assumed to be multiplexed with the names of the sub-directories as barcodes. In this case, a sample sheet can be provided with <code>--sample_sheet</code>.</p>
<pre><code>(i)                     (ii)                 (iii)    
input_reads.fastq   ─── input_directory  ─── input_directory
                        ├── reads0.fastq     ├── barcode01
                        └── reads1.fastq     │   ├── reads0.fastq
                                             │   └── reads1.fastq
                                             ├── barcode02
                                             │   ├── reads0.fastq
                                             │   ├── reads1.fastq
                                             │   └── reads2.fastq
                                             └── barcode03
                                              └── reads0.fastq
</code></pre>
<h2 id="input-parameters">Input parameters</h2>
<h3 id="input-options">Input Options</h3>
<table>
<thead>
<tr>
<th>Nextflow parameter name</th>
<th>Type</th>
<th>Description</th>
<th>Help</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>fastq</td>
<td>string</td>
<td>FASTQ files to use in the analysis.</td>
<td>This accepts one of three cases: (i) the path to a single FASTQ file; (ii) the path to a top-level directory containing FASTQ files; (iii) the path to a directory containing one level of sub-directories which in turn contain FASTQ files. In the first and second case, a sample name can be supplied with <code>--sample</code>. In the last case, the data is assumed to be multiplexed with the names of the sub-directories as barcodes. In this case, a sample sheet can be provided with <code>--sample_sheet</code>.</td>
<td></td>
</tr>
<tr>
<td>bam</td>
<td>string</td>
<td>BAM or unaligned BAM (uBAM) files to use in the analysis.</td>
<td>This accepts one of three cases: (i) the path to a single BAM file; (ii) the path to a top-level directory containing BAM files; (iii) the path to a directory containing one level of sub-directories which in turn contain BAM files. In the first and second case, a sample name can be supplied with <code>--sample</code>. In the last case, the data is assumed to be multiplexed with the names of the sub-directories as barcodes. In this case, a sample sheet can be provided with <code>--sample_sheet</code>.</td>
<td></td>
</tr>
<tr>
<td>transcriptome_source</td>
<td>string</td>
<td>Select how the transcriptome used for analysis should be prepared.</td>
<td>For differential expression analysis, use of an existing transcriptome may be preferred and so 'precomputed' should be selected. In this case the 'ref_transcriptome' parameter should be specified. To create a reference transcriptome using an existing reference genome, select 'reference guided' and specify the 'ref_genome' parameter.</td>
<td>reference-guided</td>
</tr>
<tr>
<td>ref_genome</td>
<td>string</td>
<td>Path to reference genome sequence [.fa/.fq/.fa.gz/fq.gz]. Required for reference-based workflow.</td>
<td>A reference genome is required for reference-based assembly of a transcriptome.</td>
<td></td>
</tr>
<tr>
<td>ref_transcriptome</td>
<td>string</td>
<td>Transcriptome reference file. Required for precomputed transcriptome calculation and for differential expression analysis.</td>
<td>A reference transcriptome related to the sample under study. Must be supplied when the 'Transcriptome source' parameter has been set to 'precomputed' or to perform differential expression.</td>
<td></td>
</tr>
<tr>
<td>ref_annotation</td>
<td>string</td>
<td>A reference annotation in GFF2 or GFF3 format (extensions .gtf(.gz), .gff(.gz), .gff3(.gz)). Only annotation files from <a href="https://www.encodeproject.org">Encode</a>, <a href="https://www.ensembl.org/index.html">Ensembl</a> and <a href="https://www.ncbi.nlm.nih.gov/">NCBI</a> are supported.</td>
<td>This will be used for guiding the transcriptome assembly and to label transcripts with their corresponding gene identifiers. Note: If in de_analysis mode transcript strands must be only + or -.</td>
<td></td>
</tr>
<tr>
<td>direct_rna</td>
<td>boolean</td>
<td>Set to true for direct RNA sequencing.</td>
<td>Omits the pychopper step.</td>
<td>False</td>
</tr>
<tr>
<td>analyse_unclassified</td>
<td>boolean</td>
<td>Analyse unclassified reads from input directory. By default the workflow will not process reads in the unclassified directory.</td>
<td>If selected and if the input is a multiplex directory the workflow will also process the unclassified directory.</td>
<td>False</td>
</tr>
</tbody>
</table>
<h3 id="output-options">Output Options</h3>
<table>
<thead>
<tr>
<th>Nextflow parameter name</th>
<th>Type</th>
<th>Description</th>
<th>Help</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>out_dir</td>
<td>string</td>
<td>Directory for output of all user-facing files.</td>
<td></td>
<td>output</td>
</tr>
<tr>
<td>igv</td>
<td>boolean</td>
<td>Visualize outputs in the EPI2ME IGV visualizer.</td>
<td>Enabling this option will visualize the output alignment files in the EPI2ME Desktop App IGV visualizer.</td>
<td>False</td>
</tr>
</tbody>
</table>
<h3 id="sample-options">Sample Options</h3>
<table>
<thead>
<tr>
<th>Nextflow parameter name</th>
<th>Type</th>
<th>Description</th>
<th>Help</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>sample_sheet</td>
<td>string</td>
<td>A CSV file used to map barcodes to sample aliases. The sample sheet can be provided when the input data is a directory containing sub-directories with FASTQ files. If you are running the differential expression workflow, there must be an additional column <code>condition</code> with two labels, one of which must be <code>control</code> (e.g. <code>control</code> and <code>treated</code>). Control will indicate which samples will be used as the reference. There should be at least 3 repeats for each condition.</td>
<td>The sample sheet is a CSV file with, minimally, columns named <code>barcode</code> and <code>alias</code>. Extra columns are allowed.</td>
<td></td>
</tr>
<tr>
<td>sample</td>
<td>string</td>
<td>A single sample name for non-multiplexed data. Permissible if passing a single .fastq(.gz) file or directory of .fastq(.gz) files.</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="options-for-reference-based-workflow">Options for reference-based workflow</h3>
<table>
<thead>
<tr>
<th>Nextflow parameter name</th>
<th>Type</th>
<th>Description</th>
<th>Help</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>plot_gffcmp_stats</td>
<td>boolean</td>
<td>Create a PDF of plots from showing gffcompare results</td>
<td>If set to true, a PDF file containing detailed gffcompare reults will be output</td>
<td>True</td>
</tr>
<tr>
<td>gffcompare_opts</td>
<td>string</td>
<td>Extra command-line options to give to gffcompare -r</td>
<td>For a list of possible options see <a href="https://ccb.jhu.edu/software/stringtie/gffcompare.shtml">gffcompare</a>.</td>
<td>-R</td>
</tr>
<tr>
<td>minimap2_index_opts</td>
<td>string</td>
<td>Extra command-line options for minimap2 indexing.</td>
<td>See <a href="https://lh3.github.io/minimap2/minimap2.html#4">minimap2 index options</a> for more information. These will only be relevant in the reference based transcriptome assembly.</td>
<td>-k 14</td>
</tr>
<tr>
<td>minimap2_opts</td>
<td>string</td>
<td>Additional command-line options for minimap2 alignment.</td>
<td>See <a href="https://lh3.github.io/minimap2/minimap2.html#5">minimap2 options</a> for further information. These will only be relevant in the reference based transcriptome assembly.</td>
<td>-uf</td>
</tr>
<tr>
<td>minimum_mapping_quality</td>
<td>integer</td>
<td>filter aligned reads by MAPQ quality.</td>
<td>Reads that do not meet this mapping quality after minimap2 alignment, will be filtered out.</td>
<td>40</td>
</tr>
<tr>
<td>stringtie_opts</td>
<td>string</td>
<td>Extra command-line options for stringtie transcript assembly.</td>
<td>For additional String tie options see <a href="https://github.com/gpertea/stringtie#stringtie-options">here</a>.</td>
<td>--conservative</td>
</tr>
</tbody>
</table>
<h3 id="differential-expression-options">Differential Expression Options</h3>
<table>
<thead>
<tr>
<th>Nextflow parameter name</th>
<th>Type</th>
<th>Description</th>
<th>Help</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>de_analysis</td>
<td>boolean</td>
<td>Run DE anaylsis</td>
<td>Running this requires you to provide at least two replicates for a control and treated sample as well as a sample sheet param.</td>
<td>False</td>
</tr>
<tr>
<td>min_gene_expr</td>
<td>integer</td>
<td>The minimum number of total mapped sequence reads required for a gene to be considered in differential transcript usage analysis.</td>
<td>Filtering at the gene level ensures that the observed transcript ratios are calculated with a minimum number of counts per gene.</td>
<td>10</td>
</tr>
<tr>
<td>min_feature_expr</td>
<td>integer</td>
<td>The minimum number of reads assigned to a transcript for it to be considered in differential transcript usage analysis.</td>
<td>Filter out transcripts that do not have this minimum number of transcript expression, reducing noise.</td>
<td>3</td>
</tr>
<tr>
<td>min_samps_gene_expr</td>
<td>integer</td>
<td>Set the minimum number of samples in which a gene is expressed to be included in the differential transcript usage analysis.</td>
<td>A gene must be expressed in at least this number of samples for the gene be included in the differential transcript usage analysis. Filtering at the gene level improves the reliability of the observed transcript ratios.</td>
<td>3</td>
</tr>
<tr>
<td>min_samps_feature_expr</td>
<td>integer</td>
<td>Set the minimum number of samples in which a transcript is expressed to be included in the differential transcript usage analysis.</td>
<td>A transcript must expressed in at least this minimum number of samples to be included in the analysis. Should be equal to the number of replicates per sample you have.</td>
<td>1</td>
</tr>
</tbody>
</table>
<h3 id="advanced-options">Advanced Options</h3>
<table>
<thead>
<tr>
<th>Nextflow parameter name</th>
<th>Type</th>
<th>Description</th>
<th>Help</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>threads</td>
<td>integer</td>
<td>Number of CPU threads.</td>
<td>Only provided to processes including alignment and and assembly that benefit from multiple threads.</td>
<td>4</td>
</tr>
<tr>
<td>cdna_kit</td>
<td>string</td>
<td>If cDNA reads are used, select the kit used.</td>
<td>This will be used by pychopper to preprocess the reads for downstream analysis.</td>
<td>SQK-PCS109</td>
</tr>
<tr>
<td>pychopper_backend</td>
<td>string</td>
<td>Pychopper can use one of two available backends for identifying primers in the raw reads</td>
<td>'edlib' is set by default due to its high performance. However, it may be less sensitive than 'phmm'.</td>
<td>edlib</td>
</tr>
<tr>
<td>pychopper_opts</td>
<td>string</td>
<td>Extra pychopper opts</td>
<td>See available options (here)[https://github.com/epi2me-labs/pychopper#usage]</td>
<td></td>
</tr>
<tr>
<td>bundle_min_reads</td>
<td>integer</td>
<td>Minimum size of bam bundle for parallel processing.</td>
<td></td>
<td>50000</td>
</tr>
<tr>
<td>isoform_table_nrows</td>
<td>integer</td>
<td>Maximum rows to dispay in the isoform report table</td>
<td></td>
<td>5000</td>
</tr>
</tbody>
</table>
<h2 id="outputs">Outputs</h2>
<p>Output files may be aggregated including information for all samples or provided per sample. Per-sample files will be prefixed with respective aliases and represented below as {{ alias }}.</p>
<table>
<thead>
<tr>
<th>Title</th>
<th>File path</th>
<th>Description</th>
<th>Per sample or aggregated</th>
</tr>
</thead>
<tbody>
<tr>
<td>workflow report</td>
<td>wf-transcriptomes-report.html</td>
<td>a HTML report document detailing the primary findings of the workflow</td>
<td>aggregated</td>
</tr>
<tr>
<td>Per file read stats</td>
<td>fastq_ingress_results/{{ alias }}//reads/fastcat_stats/per-file-stats.tsv</td>
<td>A TSV with per file read stats, including all samples.</td>
<td>aggregated</td>
</tr>
<tr>
<td>Read stats</td>
<td>fastq_ingress_results/{{ alias }}//reads/fastcat_stats/per-read-stats.tsv</td>
<td>A TSV with per read stats, including all samples.</td>
<td>aggregated</td>
</tr>
<tr>
<td>Run ID's</td>
<td>fastq_ingress_results/{{ alias }}//reads/fastcat_stats/run_ids</td>
<td>List of run IDs present in reads.</td>
<td>aggregated</td>
</tr>
<tr>
<td>Meta map json</td>
<td>fastq_ingress_results/{{ alias }}//reads/metamap.json</td>
<td>Metadata used in workflow presented in a JSON.</td>
<td>aggregated</td>
</tr>
<tr>
<td>Concatenated sequence data</td>
<td>fastq_ingress_results/{{ alias }}//reads/{{ alias }}.fastq.gz</td>
<td>Per sample reads concatenated in to one FASTQ file.</td>
<td>per-sample</td>
</tr>
<tr>
<td>Assembled transcriptome</td>
<td>{{ alias }}_transcriptome.fas</td>
<td>Per sample assembled transcriptome.  Not output if a reference annotation was supplied</td>
<td>per-sample</td>
</tr>
<tr>
<td>Annotated assembled transcriptome</td>
<td>{{ alias }}_merged_transcriptome.fas</td>
<td>Per sample annotated assembled transcriptome. Only output if a reference annotation was supplied</td>
<td>per-sample</td>
</tr>
<tr>
<td>Alignment summary statistics</td>
<td>{{ alias }}_read_aln_stats.tsv</td>
<td>Per sample alignment summary statistics.</td>
<td>per-sample</td>
</tr>
<tr>
<td>GFF compare results.</td>
<td>{{ alias }}_gffcompare</td>
<td>All GFF compare output files.</td>
<td>per-sample</td>
</tr>
<tr>
<td>Differential gene expression results</td>
<td>de_analysis/results_dge.tsv</td>
<td>This is a gene-level result file that describes genes and their probability of showing differential expression between experimental conditions.</td>
<td>aggregated</td>
</tr>
<tr>
<td>Differential gene expression report</td>
<td>de_analysis/results_dge.pdf</td>
<td>Summary report of differential gene expression analysis as a PDF.</td>
<td>aggregated</td>
</tr>
<tr>
<td>Differential transcript usage gene TSV</td>
<td>de_analysis/results_dtu_gene.tsv</td>
<td>This is a gene-level result file from DEXSeq that lists annotated genes and their probabilities of differential expression.</td>
<td>aggregated</td>
</tr>
<tr>
<td>Differential transcript usage report</td>
<td>de_analysis/results_dtu.pdf</td>
<td>Summary report of differential transcript usage results as a PDF.</td>
<td>aggregated</td>
</tr>
<tr>
<td>Differential transcript usage TSV</td>
<td>de_analysis/results_dtu_transcript.tsv</td>
<td>This is a transcript-level result file from DEXSeq that lists annotated genes and their probabilities of differential expression.</td>
<td>aggregated</td>
</tr>
<tr>
<td>Differential transcript usage stageR TSV</td>
<td>de_analysis/results_dtu_stageR.tsv</td>
<td>This is the output from StageR and it shows both gene and transcript probabilities of differential expression</td>
<td>aggregated</td>
</tr>
<tr>
<td>Differential transcript usage DEXSeq TSV</td>
<td>de_analysis/results_dexseq.tsv</td>
<td>The complete output from the DEXSeq-analysis, shows both gene and transcript probabilities of differential expression.</td>
<td>aggregated</td>
</tr>
<tr>
<td>Gene counts</td>
<td>de_analysis/all_gene_counts.tsv</td>
<td>Raw gene counts created by the Salmon tool, before filtering.</td>
<td>aggregated</td>
</tr>
<tr>
<td>Gene counts per million</td>
<td>de_analysis/cpm_gene_counts.tsv</td>
<td>This file shows counts per million (CPM) of the raw gene counts to facilitate comparisons across samples.</td>
<td>aggregated</td>
</tr>
<tr>
<td>Transcript counts</td>
<td>de_analysis/unfiltered_transcript_counts_with_genes.tsv</td>
<td>Raw transcript counts created by the Salmon tool, before filtering. Includes reference to the associated gene ID.</td>
<td>aggregated</td>
</tr>
<tr>
<td>Transcript per million counts</td>
<td>de_analysis/unfiltered_tpm_transcript_counts.tsv</td>
<td>This file shows transcripts per million (TPM) of the raw counts to facilitate comparisons across samples.</td>
<td>aggregated</td>
</tr>
<tr>
<td>Transcript counts filtered</td>
<td>de_analysis/filtered_transcript_counts_with_genes.tsv</td>
<td>Filtered transcript counts, used for differential transcript usage analysis. Includes a reference to the associated gene ID.</td>
<td>aggregated</td>
</tr>
<tr>
<td>Transcript info table</td>
<td>{{ alias }}_transcripts_table.tsv</td>
<td>This file details each isoform that was reconstructed from the input reads. It contains a subset of columns from the .tmap output from <a href="https://ccb.jhu.edu/software/stringtie/gffcompare.shtml">gffcompare</a></td>
<td>per-sample</td>
</tr>
<tr>
<td>Final non redundant transcriptome</td>
<td>de_analysis/final_non_redundant_transcriptome.fasta</td>
<td>Transcripts that were used for differential expression analysis including novel transcripts with the identifiers used for DE analysis. Only applicable when the ref_transcriptome parameter is not provided.</td>
<td>aggregated</td>
</tr>
<tr>
<td>Index of reference FASTA file</td>
<td>igv_reference/{{ ref_genome_file }}.fai</td>
<td>Reference genome index of the FASTA file required for IGV config.</td>
<td>aggregated</td>
</tr>
<tr>
<td>GZI index of the reference FASTA file</td>
<td>igv_reference/{{ ref_genome_file }}.gzi</td>
<td>GZI Index of the reference FASTA file.</td>
<td>aggregated</td>
</tr>
<tr>
<td>JSON configuration file for IGV browser</td>
<td>igv.json</td>
<td>JSON configuration file to be loaded in IGV for visualising alignments against the reference.</td>
<td>aggregated</td>
</tr>
<tr>
<td>BAM file (minimap2)</td>
<td>BAMS/{{ alias }}.reads_aln_sorted.bam</td>
<td>BAM file generated from mapping input reads to the reference.</td>
<td>per-sample</td>
</tr>
<tr>
<td>BAM index file (minimap2)</td>
<td>BAMS/{{ alias }}.reads_aln_sort.bam.bai</td>
<td>Index file generated from mapping input reads to the reference.</td>
<td>per-sample</td>
</tr>
</tbody>
</table>
<h2 id="pipeline-overview">Pipeline overview</h2>
<h3 id="1-concatenate-input-files-and-generate-per-read-stats">1. Concatenate input files and generate per read stats.</h3>
<p>The <a href="https://github.com/epi2me-labs/fastcat">fastcat</a> tool is used to concatenate multifile samples to be processed by the workflow. It will also output per read stats including average read lengths and qualities.</p>
<h3 id="2-preprocess-cdna">2. Preprocess cDNA.</h3>
<p>If input sequences are cDNA <a href="https://github.com/epi2me-labs/pychopper">Pychopper</a> is used to orient, trim and rescue full length cDNA reads and associated statistics. If the <code>direct_rna</code> parameter is selected this step will be skipped.</p>
<h3 id="3-build-transcriptome">3. Build transcriptome.</h3>
<p>If the <code>transcriptome_source</code> parameter is "reference-guided" a transcriptome will be built for each sample as outlined below. If the <code>transcriptome_source</code> is "precomputed" and the <code>reference_transcriptome</code> parameter is provided the workflow will skip step 3.</p>
<h4 id="31-align-reads-with-reference-genome">3.1 Align reads with reference genome.</h4>
<p>The reference genome will be indexed and aligned using <a href="https://github.com/lh3/minimap2">Minimap2</a>. The output is sorted and converted to a BAM file using <a href="https://www.htslib.org/">Samtools</a>. Alignment stats are created from these using <a href="https://bioinf.shenwei.me/seqkit/usage/#bam">Seqkit BAM</a>.</p>
<p>Additionally, the workflow will generate an IGV configuration file if <code>--igv</code> is selected. This file allows the user to view the aligned BAM in the EPI2ME Desktop Application in the Viewer tab.</p>
<h4 id="32-chunk-bam">3.2 Chunk BAM</h4>
<p>The aligned BAMs are split into chunks using the bundle_min_reads parameter (default: 50000).</p>
<h4 id="33-assemble-transcripts">3.3 Assemble transcripts</h4>
<p><a href="https://ccb.jhu.edu/software/stringtie/">StringTie</a> is then used to assemble the transcripts using the aligned segments in the chunked BAM files. The assembled transcript will be output as a <a href="https://www.ensembl.org/info/website/upload/gff3.html">GFF file</a>. If a <code>ref_annotation</code> file is provided this will also be included in the GFF.</p>
<h4 id="34-merge-chunks">3.4 Merge Chunks</h4>
<p>Transcript GFF files from the chunks with the same sample aliases will then be merged.</p>
<h4 id="35-annnotate">3.5 Annnotate</h4>
<p><a href="https://ccb.jhu.edu/software/stringtie/gffcompare.html">GffCompare</a> is then used to compare query and reference annotations, merging records where appropriate and then annotating them. This also creates estimates of accuracy of the GFF files output in a stats file per sample.</p>
<h4 id="36-create-transcriptomes">3.6 Create transcriptomes</h4>
<p><a href="https://github.com/gpertea/gffread">Gffread</a> is used to create a transcriptome FASTA file from the final GFF as well as a merged transcriptome that includes annotations in the FASTA headers where available.</p>
<h3 id="4-differential-expression-analysis">4. Differential expression analysis</h3>
<p>Differential gene expression (DGE) and differential transcript usage (DTU) analyses aim to identify genes and transcripts that show statistically altered expression patterns.</p>
<p>Differential Expression requires at least 2 replicates of each sample to compare (but we recommend three). You can see an example sample_sheet.csv below.</p>
<h4 id="sample-sheet-condition-column">Sample sheet condition column</h4>
<p>The sample sheet should be a comma separated values file (.csv) and include at least three columns named <code>barcode</code>, <code>alias</code> and <code>condition</code>.
- Each <code>barcode</code> should refer to a directory of the same name in the input FASTQ directory (in the example below <code>barcode01</code> to <code>barcode06</code> reflect the <code>test_data</code> directory).
- The <code>alias</code> column allows you to rename each barcode to an alias that will be used in the report and other output files.
- The condition column will need to contain one of two keys to indicate the two samples being compared. Control must be one of the keys, used to indicate which samples will be used as the reference in the differential expression analysis.</p>
<p>eg. sample_sheet.csv</p>
<pre><code>barcode,alias,condition
barcode01,sample01,control
barcode02,sample02,control
barcode03,sample03,control
barcode04,sample04,treated
barcode05,sample05,treated
barcode06,sample06,treated
</code></pre>
<h4 id="41-merge-cross-sample-transcriptomes">4.1 Merge cross sample transcriptomes</h4>
<p>If a <code>ref_transcriptome</code> is not provided, the transcriptomes created by the workflow will be used for DE analysis. To do this, the GFF outputs of GffCompare are merged using StringTie. A final non redundant FASTA file of the transcripts is created using the merged GFF file and the reference genome using seqkit.</p>
<h4 id="42-create-a-final-non-redundant-transcriptome">4.2 Create a final non redundant transcriptome</h4>
<p>The reads from all the samples will be aligned with the final non redundant transcriptome using Minimap2 in a splice aware manner.</p>
<h4 id="43-count-genes-and-transcripts">4.3 Count genes and transcripts</h4>
<p><a href="https://github.com/COMBINE-lab/salmon">Salmon</a> is used for transcript quantification, giving gene and transcript counts.</p>
<h4 id="44-edger-based-differential-expression-analysis">4.4 edgeR based differential expression analysis</h4>
<p>A statistical analysis is first performed using <a href="https://bioconductor.org/packages/release/bioc/html/edgeR.html">edgeR</a> to identify the subset of differentially expressed genes using the gene counts as input. A normalisation factor is calculated for each sequence library using the default TMM method (see <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3378882/">McCarthy et al. (2012)</a> for further details). The defined experimental design is used to calculate estimates of dispersion for each of the gene features. Statistical tests are calculated using the contrasts defined in the experimental design. The differentially expressed genes are corrected for false discovery (FDR) using the method of Benjamini &amp; Hochberg (<a href="https://www.jstor.org/stable/2346101">Benjamini and Hochberg (1995)</a>)</p>
<h4 id="45-pre-filtering-of-quantitative-data-using-drimseq">4.5 Pre-filtering of quantitative data using DRIMSeq</h4>
<p><a href="https://bioconductor.org/packages/release/bioc/html/DRIMSeq.html">DRIMSeq</a> is used to filter the transcript count data from the Salmon analysis for differential transcript usage (DTU) analysis. The filter step will be used to select for genes and transcripts that satisfy rules for the number of samples in which a gene or transcript must be observed, and minimum threshold levels for the number of observed reads. The parameters used for filtering are <code>min_samps_gene_expr</code>, <code>min_samps_feature_expr</code>, <code>min_gene_expr</code>, and <code>min_feature_expr</code>. By default, any transcripts with zero expression or one transcript in all samples are filtered out at this stage.</p>
<h4 id="46-differential-transcript-usage-using-dexseq">4.6 Differential transcript usage using DEXSeq</h4>
<p>Differential transcript usage analysis is performed using the R <a href="https://bioconductor.org/packages/release/bioc/html/DEXSeq.html">DEXSeq</a> package (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3460195/">Anders et al. (2012)</a>). Similar to the edgeR package, DEXSeq estimates the variance between the biological replicates and applies generalised linear models for the statistical testing. The key difference is that the DEXSeq method looks for differences at the exon count level. DEXSeq uses the filtered transcript count data prepared earlier in this analysis. </p>
<h4 id="47-stager-stage-wise-analysis-of-dge-and-dtu">4.7 StageR stage-wise analysis of DGE and DTU</h4>
<p>The final component of this isoform analysis is a stage-wise statistical test using the R software package <a href="https://bioconductor.org/packages/release/bioc/html/stageR.html">stageR</a>(<a href="https://genomebiology.biomedcentral.com/articles/10.1186/s13059-017-1277-0">Van den Berge and Clement (2018)</a>). stageR uses (1) the raw p-values for DTU from the DEXSeq analysis in the previous section and (2) a false-discovery corrected set of p-values from testing whether individual genes contain at least one exon showing DTU. A hierarchical two-stage statistical testing evaluates the set of genes for DTU.</p>
<h2 id="troubleshooting">Troubleshooting</h2>
<ul>
<li>If the workflow fails please run it with the demo data set to ensure the workflow itself is working. This will help us determine if the issue is related to the environment, input parameters or a bug.</li>
<li>See how to interpret some common nextflow exit codes <a href="https://labs.epi2me.io/trouble-shooting/">here</a>.</li>
<li>Renaming, moving or deleting the input BAM, reference genome or the output directory from the location provided at runtime will stop IGV in the EPI2ME Desktop app from loading.</li>
</ul>
<h2 id="faqs">FAQ's</h2>
<p><em>Does the workflow support de novo assembly?</em> - Currently the workflow does not have a <em>de novo</em> mode.</p>
<p><em>Why is the IGV panel not showing?</em> - The workflow expects either an uncompressed or <a href="https://www.htslib.org/doc/bgzip.html"><code>bgzip</code></a>-compressed reference. If the user provides a reference compressed not with <code>bgzip</code>, the workflow will run to completion, but won't be able to generate the necessary indexes to visualize the outputs in IGV.</p>
<p>If your question is not answered here, please report any issues or suggestions on the <a href="https://github.com/epi2me-labs/wf-transcriptomes/issues">github issues</a> page or start a discussion on the <a href="https://community.nanoporetech.com/">community</a>.</p>
<h2 id="related-blog-posts">Related blog posts</h2>
<ul>
<li><a href="https://labs.epi2me.io/how-to-align/">How to align your data</a></li>
</ul>
<p>See the <a href="https://labs.epi2me.io/">EPI2ME website</a> for lots of other resources and blog posts.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      © 2020 - 2024 Oxford Nanopore Technologies plc. All rights reserved. Registered Office: Gosling Building, Edmund Halley Road, Oxford Science Park, OX4 4DQ, UK | Registered No. 05386273 | VAT No 336942382. Oxford Nanopore Technologies, the Wheel icon, EPI2ME, Flongle, GridION, Metrichor, MinION, MinIT, MinKNOW, Plongle, PromethION, SmidgION, Ubik and VolTRAX are registered trademarks of Oxford Nanopore Technologies plc in various countries. Oxford Nanopore Technologies products are not intended for use for health assessment or to diagnose, treat, mitigate, cure, or prevent any disease or condition." <br /> <a href="#__consent">Change cookie settings</a>

    </div>
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            


  


<h4>Cookie consent</h4>
<p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p>
<input class="md-toggle" type="checkbox" id="__settings" >
<div class="md-consent__settings">
  <ul class="task-list">
    
    
      
    
    
      
    
    
      
        
  
  
    
    
      
    
  
  <li class="task-list-item">
    <label class="task-list-control">
      <input type="checkbox" name="custom" checked>
      <span class="task-list-indicator"></span>
      heap.io
    </label>
  </li>

      
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Accept</button>
    
    
    
  
    
    
    
      <label class="md-button" for="__settings">Manage settings</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script>
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant", "navigation.path", "navigation.top", "navigation.indexes", "search.suggest", "search.highlight", "search.share"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  </body>
</html>